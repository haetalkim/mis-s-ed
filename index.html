<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MISSED - TC Community Platform</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>

<div class="device-frame">
  <div class="notch"></div>
  <div class="inner-screen" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
    
    <!-- SPLASH SCREEN -->
    <div id="splash-screen" class="splash-screen">
      <div class="app-title" id="app-title">
        <span class="letter m">m</span><span class="letter i1">i</span><span class="letter s1">s</span><span class="letter s2">s</span><span class="letter e">e</span><span class="letter d">d</span>
      </div>
      <div class="author-text">Guiyoung / Jiin</div>
      <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fwehpv%2FdJMb9YcaOax%2FAAAAAAAAAAAAAAAAAAAAACG42sJ3u2H9g7edV1eUPJ7zEAa3pIPXAgSOJ3s1X1FR%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3DoJ3II%252Fr2eT5fa80snR8BTMrbxOc%253D" class="tc-logo" alt="TC Logo" />
    </div>

    <!-- ONBOARDING SCREENS -->
    <div id="onboarding" class="onboarding-container">
      <!-- Welcome Screen -->
      <div class="onboarding-screen active" data-screen="1">
        <div class="flex flex-col items-center justify-center h-full px-8 text-center">
          <div class="text-6xl mb-6">üëã</div>
          <h2 class="text-2xl font-bold text-gray-900 mb-3">Welcome to MISSED</h2>
          <p class="text-base text-gray-600 mb-8">A safe space for TML international students to share verified information and support each other</p>
          <button onclick="nextOnboarding()" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold">Get Started</button>
        </div>
      </div>

      <!-- Feature 1: Verified Info -->
      <div class="onboarding-screen" data-screen="2">
        <div class="flex flex-col items-center justify-center h-full px-8 text-center">
          <div class="text-6xl mb-6">‚úÖ</div>
          <h2 class="text-2xl font-bold text-gray-900 mb-3">Verified Information</h2>
          <p class="text-base text-gray-600 mb-8">Posts with sources are verified by moderators to ensure accuracy. Look for the green checkmark!</p>
          <div class="flex gap-3">
            <button onclick="prevOnboarding()" class="text-gray-600 px-6 py-3 rounded-xl font-semibold">Back</button>
            <button onclick="nextOnboarding()" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold">Next</button>
          </div>
        </div>
      </div>

      <!-- Feature 2: Report Misinformation -->
      <div class="onboarding-screen" data-screen="3">
        <div class="flex flex-col items-center justify-center h-full px-8 text-center">
          <div class="text-6xl mb-6">üö®</div>
          <h2 class="text-2xl font-bold text-gray-900 mb-3">Report Concerns</h2>
          <p class="text-base text-gray-600 mb-4">See something that doesn't seem right? Report it to help keep our community safe.</p>
          <div class="bg-white rounded-2xl p-4 mb-6 text-left space-y-2">
            <p class="text-sm text-gray-700"><span class="font-bold">üìã</span> Missing source or unclear facts</p>
            <p class="text-sm text-gray-700"><span class="font-bold">‚ö†Ô∏è</span> Potentially misleading information</p>
            <p class="text-sm text-gray-700"><span class="font-bold">üö´</span> Inappropriate or harmful content</p>
          </div>
          <p class="text-xs text-gray-500 mb-6">Your reports help moderators verify and correct information</p>
          <div class="flex gap-3">
            <button onclick="prevOnboarding()" class="text-gray-600 px-6 py-3 rounded-xl font-semibold">Back</button>
            <button onclick="nextOnboarding()" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold">Next</button>
          </div>
        </div>
      </div>

      <!-- Feature 3: Connect -->
      <div class="onboarding-screen" data-screen="4">
        <div class="flex flex-col items-center justify-center h-full px-8 text-center">
          <div class="text-6xl mb-6">ü§ù</div>
          <h2 class="text-2xl font-bold text-gray-900 mb-3">Build Trust Networks</h2>
          <p class="text-base text-gray-600 mb-8">Connect with peers through Academic Profile Handshake. Share schedules and collaborate safely</p>
          <div class="flex gap-3">
            <button onclick="prevOnboarding()" class="text-gray-600 px-6 py-3 rounded-xl font-semibold">Back</button>
            <button onclick="finishOnboarding()" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold">Start Using MISSED</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- LOGIN PAGE -->
    <div id="login-page" class="login-container overflow-y-auto">
      <div class="flex flex-col items-center justify-end min-h-full px-6 pt-8 pb-16">
        <!-- TC Logo - positioned above the form -->
        <div class="mb-6">
          <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fwehpv%2FdJMb9YcaOax%2FAAAAAAAAAAAAAAAAAAAAACG42sJ3u2H9g7edV1eUPJ7zEAa3pIPXAgSOJ3s1X1FR%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3DoJ3II%252Fr2eT5fa80snR8BTMrbxOc%253D" class="w-20 h-20 flex-shrink-0" alt="TC Logo" style="filter: brightness(0) invert(1);" />
        </div>
        
        <!-- Login/Signup Form Container -->
        <div class="bg-white rounded-3xl p-6 pb-8 shadow-2xl w-full max-w-sm">
          <h2 class="text-2xl font-bold text-gray-900 mb-4 text-center">Welcome to MISSED</h2>
          
          <!-- Tab Buttons -->
          <div class="flex gap-2 mb-6 bg-gray-100 rounded-xl p-1">
            <button 
              onclick="switchAuthTab('signin')" 
              id="signin-tab"
              class="flex-1 py-2.5 rounded-lg font-semibold text-sm transition-colors bg-blue-600 text-white"
            >
              Sign In
            </button>
            <button 
              onclick="switchAuthTab('signup')" 
              id="signup-tab"
              class="flex-1 py-2.5 rounded-lg font-semibold text-sm transition-colors text-gray-600 hover:text-gray-900"
            >
              Sign Up
            </button>
          </div>
          
          <!-- Sign In Form -->
          <div id="signin-form-container">
            <form id="signin-form" onsubmit="handleSignIn(event)" class="space-y-5">
              <div>
                <label class="text-xs font-semibold text-gray-700 mb-2.5 block">Email Address</label>
                <div class="flex items-stretch overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm">
                  <input 
                    type="text" 
                    id="signin-email-username" 
                    placeholder="UNI" 
                    class="flex-1 px-4 py-3.5 bg-white text-sm focus:outline-none min-w-0"
                    required
                    autocomplete="username"
                    style="border: none;"
                  />
                  <span class="px-3 py-3.5 bg-gray-50 text-sm text-gray-600 flex items-center whitespace-nowrap border-l border-gray-200">@tc.columbia.edu</span>
                </div>
              </div>
              
              <div>
                <label class="text-xs font-semibold text-gray-700 mb-2.5 block">Password</label>
                <input 
                  type="password" 
                  id="signin-password" 
                  placeholder="Enter your password" 
                  class="w-full px-4 py-3.5 rounded-2xl bg-white border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm"
                  required
                  autocomplete="current-password"
                />
              </div>
              
              <button 
                type="submit" 
                id="signin-submit-btn"
                class="w-full bg-blue-600 text-white py-3.5 rounded-2xl font-semibold text-sm hover:bg-blue-700 transition-colors shadow-sm"
              >
                Sign In
              </button>
            </form>
            
            <div class="bg-blue-50 rounded-2xl p-3.5 mt-6">
              <p class="text-xs text-blue-800 text-center">
                <span class="font-semibold">üîí Secure:</span> Only Columbia Teacher College students can access
              </p>
            </div>
            
            <!-- Trial Login -->
            <div class="mt-6 pt-6 border-t border-gray-200">
              <p class="text-xs text-gray-500 text-center mb-3">Try the app with a demo account:</p>
              <button 
                type="button"
                onclick="fillTrialLogin()"
                class="w-full bg-gray-100 text-gray-700 py-2.5 rounded-2xl font-medium text-xs hover:bg-gray-200 transition-colors"
              >
                üß™ Use Trial Account (haetalkim)
              </button>
            </div>
          </div>
          
          <!-- Sign Up Form (Step 1: Email with Verification) -->
          <div id="signup-form-container" class="hidden">
            <form id="signup-email-form" onsubmit="handleSignUpEmail(event)" class="space-y-5">
              <div>
                <label class="text-xs font-semibold text-gray-700 mb-2.5 block">Email Address</label>
                <div class="flex items-stretch overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm">
                  <input 
                    type="text" 
                    id="signup-email-username" 
                    placeholder="UNI" 
                    class="flex-1 px-4 py-3.5 bg-white text-sm focus:outline-none min-w-0"
                    required
                    autocomplete="username"
                    style="border: none;"
                  />
                  <span class="px-3 py-3.5 bg-gray-50 text-sm text-gray-600 flex items-center whitespace-nowrap border-l border-gray-200">@tc.columbia.edu</span>
                </div>
                <p class="text-xs text-gray-500 mt-2">We'll send a verification code to this email</p>
              </div>
              
              <button 
                type="submit" 
                id="signup-email-submit-btn"
                class="w-full bg-blue-600 text-white py-3.5 rounded-2xl font-semibold text-sm hover:bg-blue-700 transition-colors shadow-sm"
              >
                Send Verification Code
              </button>
            </form>
            
            <div class="bg-blue-50 rounded-2xl p-3.5 mt-6">
              <p class="text-xs text-blue-800 text-center">
                <span class="font-semibold">üîí Secure Sign Up:</span> We'll verify your TC email address
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- AUTH CODE VERIFICATION MODAL (for Sign Up) -->
    <div id="auth-code-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-[60] items-center justify-center overflow-y-auto py-8">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-6 shadow-2xl mx-4 my-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-900">Enter Verification Code</h3>
          <button onclick="closeAuthCodeModal()" class="text-gray-400 text-xl hover:text-gray-600">&times;</button>
        </div>
        
        <div class="mb-4">
          <p class="text-sm text-gray-600 mb-4">
            We've sent a 6-digit code to <span id="auth-email-display" class="font-semibold text-gray-900"></span>
          </p>
          <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-2 mb-4">
            <p class="text-xs text-yellow-800 text-center">
              <span class="font-semibold">Demo:</span> Use code <span class="font-mono font-bold">123456</span> to continue
            </p>
          </div>
        
          <form id="auth-code-form" onsubmit="verifySignUpCode(event)">
            <div class="mb-4">
              <label class="text-xs font-semibold text-gray-700 mb-2 block">Verification Code</label>
              <input 
                type="text" 
                id="auth-code-input" 
                placeholder="000000" 
                maxlength="6"
                pattern="[0-9]{6}"
                inputmode="numeric"
                class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-center text-2xl font-bold tracking-widest focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                required
                autocomplete="one-time-code"
                oninput="this.value = this.value.replace(/[^0-9]/g, '')"
              />
              <p class="text-xs text-gray-500 mt-2 text-center">Enter the 6-digit code from your email</p>
            </div>
            
            <button 
              type="submit" 
              class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold text-sm hover:bg-blue-700 transition-colors mb-3"
            >
              Verify Code
            </button>
          </form>
          
          <div class="text-center">
            <button onclick="resendAuthCode()" class="text-sm text-blue-600 hover:text-blue-700 font-semibold">
              Resend Code
            </button>
            <p id="resend-timer" class="text-xs text-gray-500 mt-2 hidden">Resend available in <span id="timer-count">60</span>s</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- SIGNUP PASSWORD MODAL -->
    <div id="signup-password-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-[60] items-center justify-center overflow-y-auto py-8">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-6 shadow-2xl mx-4 my-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-900">Create Password</h3>
          <button onclick="closeSignUpPasswordModal()" class="text-gray-400 text-xl hover:text-gray-600">&times;</button>
        </div>
        
        <form id="signup-password-form" onsubmit="handleSignUpPassword(event)" class="space-y-4">
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Password</label>
            <input 
              type="password" 
              id="signup-password" 
              placeholder="Create a strong password" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
              autocomplete="new-password"
              minlength="8"
            />
            <p class="text-xs text-gray-500 mt-1">Must be at least 8 characters</p>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Confirm Password</label>
            <input 
              type="password" 
              id="signup-password-confirm" 
              placeholder="Confirm your password" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
              autocomplete="new-password"
            />
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold text-sm hover:bg-blue-700 transition-colors"
          >
            Continue to Profile Setup
          </button>
        </form>
      </div>
    </div>
    
    <!-- SIGNUP PROFILE MODAL -->
    <div id="signup-profile-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-[60] items-center justify-center overflow-y-auto py-8">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-6 shadow-2xl mx-4 my-auto max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-900">Complete Your Profile</h3>
          <button onclick="closeSignUpProfileModal()" class="text-gray-400 text-xl hover:text-gray-600">&times;</button>
        </div>
        
        <form id="signup-profile-form" onsubmit="handleSignUpProfile(event)" class="space-y-4">
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Full Name</label>
            <input 
              type="text" 
              id="signup-name" 
              placeholder="Your full name" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Program</label>
            <select 
              id="signup-program" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
              <option value="">Select your program</option>
              <option value="TML">Technology & Media (TML)</option>
              <option value="C&T">Curriculum & Teaching (C&T)</option>
              <option value="HUDK">Human Development (HUDK)</option>
              <option value="A&HA">Arts & Humanities (A&HA)</option>
              <option value="ORL">Organization & Leadership (ORL)</option>
              <option value="HBS">Health & Behavior Studies (HBS)</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Degree</label>
            <select 
              id="signup-degree" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
              <option value="">Select your degree</option>
              <option value="MA">Master of Arts (MA)</option>
              <option value="MS">Master of Science (MS)</option>
              <option value="EdM">Master of Education (EdM)</option>
              <option value="EdD">Doctor of Education (EdD)</option>
              <option value="PhD">Doctor of Philosophy (PhD)</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Year</label>
            <select 
              id="signup-year" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
              <option value="">Select your year</option>
              <option value="2024">2024</option>
              <option value="2025">2025</option>
              <option value="2026">2026</option>
              <option value="2027">2027</option>
              <option value="2028">2028</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Major/Concentration</label>
            <input 
              type="text" 
              id="signup-major" 
              placeholder="e.g., Instructional Technology & Media" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Research Interest</label>
            <textarea 
              id="signup-research-interest" 
              placeholder="e.g., Educational Technology, Learning Analytics, Human-Computer Interaction..." 
              rows="2"
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
              required
            ></textarea>
            <p class="text-xs text-gray-500 mt-1">Describe your research interests and academic focus</p>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">LinkedIn Profile (Optional)</label>
            <input 
              type="url" 
              id="signup-linkedin" 
              placeholder="https://linkedin.com/in/yourprofile" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
            <p class="text-xs text-gray-500 mt-1">Share your LinkedIn to connect with peers</p>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Lab/Research Group (Optional)</label>
            <input 
              type="text" 
              id="signup-lab" 
              placeholder="e.g., EdTech Lab, Learning Sciences Lab" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Interests (Optional)</label>
            <textarea 
              id="signup-interests" 
              placeholder="e.g., EdTech, Learning Analytics, F-1 Visa, Housing..." 
              rows="2"
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
            ></textarea>
            <p class="text-xs text-gray-500 mt-1">Separate interests with commas</p>
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold text-sm hover:bg-blue-700 transition-colors"
          >
            Complete Sign Up
          </button>
        </form>
      </div>
    </div>
    
    <!-- iPhone Status Bar -->
    <div class="status-bar flex items-center justify-between px-6 pt-3 pb-1 text-xs font-semibold text-gray-900">
      <div>9:18</div>
      <div class="flex items-center gap-1">
        <svg class="w-4 h-3" fill="currentColor" viewBox="0 0 16 12"><path d="M1.5 3h13a1 1 0 011 1v4a1 1 0 01-1 1h-13a1 1 0 01-1-1V4a1 1 0 011-1zm13.5 1.5v3h.5a.5.5 0 00.5-.5v-2a.5.5 0 00-.5-.5h-.5z"/></svg>
        <span>100%</span>
      </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto pb-20">
      
      <!-- HOME PAGE -->
      <div id="home" class="page-view active p-5 space-y-4">
        <!-- Welcome Profile Card -->
        <div onclick="showPage('profile')" class="bg-white rounded-3xl p-5 shadow-sm cursor-pointer hover:shadow-md transition-all">
          <div class="flex items-start gap-3 mb-4">
            <div class="relative flex-shrink-0">
              <img src="https://i.pinimg.com/736x/df/2f/dc/df2fdc0cc7a11a701bcf167a6142aa6d.jpg" class="w-16 h-16 rounded-full object-cover shadow-md" style="aspect-ratio: 1/1;" />
              <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center border-2 border-white">
                <span class="text-white text-xs">‚úì</span>
              </div>
            </div>
            <div class="flex-1 min-w-0">
              <h1 id="profile-card-name" class="text-lg font-bold text-gray-900 mb-1">Hi, Haetal!</h1>
              <p id="profile-card-major" class="text-xs text-gray-600 mb-1">Instr. Tech & Media</p>
              <p id="profile-card-email" class="text-xs text-blue-400">haetalkim@tc.columbia.edu</p>
            </div>
            <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FbTQKcD%2FdJMb9Wk7PKH%2FAAAAAAAAAAAAAAAAAAAAAGWy4zjapaFyTqvF1POBrNO3g7k-5pC6_o96MCrOkyhZ%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3Df1vvB0gs0q1mjRXz%252BgxwyJMPNLY%253D" class="w-10 h-10 object-contain flex-shrink-0" />
          </div>
          <div class="bg-blue-50 rounded-xl px-3 py-2 text-center">
            <span id="profile-card-status" class="text-xs font-semibold text-blue-700">‚úì Verified Student</span>
          </div>
        </div>

        <!-- Trust Score Widget -->
        <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-3xl p-5 shadow-sm">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-2">
              <div>
                <h3 class="text-sm font-semibold text-green-900 mb-1">Community Trust Score</h3>
                <p class="text-xs text-green-700">Based on verified posts & reports</p>
              </div>
              <button onclick="openTrustScoreModal()" class="w-5 h-5 bg-green-200 rounded-full flex items-center justify-center text-green-700 hover:bg-green-300 transition-colors flex-shrink-0">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                </svg>
              </button>
            </div>
            <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center text-white font-bold text-lg">
              92
            </div>
          </div>
          <div class="bg-white rounded-xl p-3">
            <div class="flex justify-between text-xs mb-1">
              <span class="text-gray-600">Trust Level</span>
              <span class="text-green-600 font-semibold">Excellent</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full" style="width: 92%"></div>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="grid grid-cols-2 gap-3">
          <button onclick="openPostModal()" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all">
            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-2">
              <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/></svg>
            </div>
            <div class="text-sm font-bold text-gray-900">New Post</div>
          </button>
          <button onclick="showPage('schedule')" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all">
            <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-2">
              <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/></svg>
            </div>
            <div class="text-sm font-bold text-gray-900">My Schedule</div>
          </button>
        </div>

        <!-- Recent Activity -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <h3 class="text-base font-bold text-gray-900 mb-3">Recent Activity</h3>
          <div class="space-y-3">
            <div class="flex items-center gap-3 pb-3 border-b border-gray-100">
              <div class="w-2 h-2 bg-green-500 rounded-full"></div>
              <div class="flex-1">
                <p class="text-sm text-gray-900"><span class="font-semibold">Jiin Hur</span> verified a post</p>
                <p class="text-xs text-gray-500">5 min ago</p>
              </div>
            </div>
            <div class="flex items-center gap-3 pb-3 border-b border-gray-100">
              <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
              <div class="flex-1">
                <p class="text-sm text-gray-900"><span class="font-semibold">2 new posts</span> in F-1 Visa Help</p>
                <p class="text-xs text-gray-500">1h ago</p>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-2 h-2 bg-red-500 rounded-full"></div>
              <div class="flex-1">
                <p class="text-sm text-gray-900"><span class="font-semibold">1 post flagged</span> for review</p>
                <p class="text-xs text-gray-500">2h ago</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Posts -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-base font-bold text-gray-900">Recent Posts</h3>
            <button onclick="showPage('communities')" class="text-blue-600 text-sm font-semibold">See all ‚Üí</button>
          </div>
          <div class="space-y-3">
            <!-- Post 1 -->
            <div onclick="openPost(1)" class="bg-gray-50 rounded-2xl p-3 cursor-pointer hover:bg-gray-100 transition-all">
              <div class="flex items-start gap-2 mb-2">
                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0">JH</div>
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-1">
                    <span class="font-semibold text-gray-900 text-sm">Jiin Hur</span>
                    <span class="bg-green-600 text-white px-1.5 py-0.5 rounded-full text-xs font-bold">‚úì</span>
                  </div>
                  <p class="text-xs text-gray-500">1h ago</p>
                </div>
              </div>
              <h4 class="font-bold text-gray-900 text-sm mb-1">Best resources for CPT application?</h4>
              <p class="text-xs text-gray-700 mb-2 line-clamp-2">I found this comprehensive guide from OISS. Has all the forms and requirements clearly listed!</p>
              <div class="flex items-center gap-3 text-xs text-gray-600">
                <span class="comment-count" data-post-id="1">üí¨ 5 comments</span>
                <span>üëç 12 likes</span>
              </div>
            </div>

            <!-- Post 2 -->
            <div onclick="openPost(2)" class="bg-gray-50 rounded-2xl p-3 cursor-pointer hover:bg-gray-100 transition-all">
              <div class="flex items-start gap-2 mb-2">
                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0">MP</div>
                <div class="flex-1 min-w-0">
                  <span class="font-semibold text-gray-900 text-sm">Min Park</span>
                  <p class="text-xs text-gray-500">2h ago</p>
                </div>
              </div>
              <h4 class="font-bold text-gray-900 text-sm mb-1">Study group for EdTech?</h4>
              <p class="text-xs text-gray-700 mb-2 line-clamp-2">Looking to form a study group for the midterm. Anyone interested?</p>
              <div class="flex items-center gap-3 text-xs text-gray-600">
                <span>üí¨ 5 comments</span>
                <span>üëç 5 likes</span>
              </div>
            </div>

            <!-- Post 3 - Flagged -->
            <div onclick="openPost(3)" class="bg-red-50 rounded-2xl p-3 border border-red-200 cursor-pointer hover:bg-red-100 transition-all">
              <div class="flex items-start gap-2 mb-2">
                <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0">??</div>
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-1">
                    <span class="font-semibold text-gray-900 text-sm">Anonymous</span>
                    <span class="bg-red-600 text-white px-1.5 py-0.5 rounded-full text-xs font-bold">‚ö†</span>
                  </div>
                  <p class="text-xs text-gray-500">4h ago</p>
                </div>
              </div>
              <h4 class="font-bold text-gray-900 text-sm mb-1">URGENT: OPT applications suspended!</h4>
              <p class="text-xs text-gray-700 mb-2 line-clamp-2">My friend at NYU said USCIS stopped processing OPT apps this week due to policy changes...</p>
              <div class="flex items-center gap-3 text-xs text-red-600">
                <span>üí¨ 8 comments</span>
                <span>üö® 5 reports</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- COMMUNITIES PAGE -->
      <div id="communities" class="page-view p-5 space-y-4">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-2xl font-bold text-gray-900">Communities</h2>
          <button onclick="showCreateCommunityMessage()" class="text-blue-600 text-sm font-semibold">+ Create</button>
        </div>

        <!-- Featured Community -->
        <div class="bg-gradient-to-br from-blue-600 to-blue-700 rounded-3xl p-5 shadow-lg text-white">
          <div class="flex items-start justify-between mb-3">
            <div>
              <h3 class="text-lg font-bold mb-1">üéì F-1 Visa Help</h3>
              <p class="text-sm text-blue-100">Official verified information</p>
            </div>
            <span class="bg-white bg-opacity-20 px-2 py-1 rounded-lg text-xs font-bold">Featured</span>
          </div>
          <div class="flex items-center gap-4 mb-4">
            <div class="text-center">
              <div class="text-2xl font-bold">248</div>
              <div class="text-xs text-blue-100">members</div>
            </div>
            <div class="text-center">
              <div class="text-2xl font-bold">89%</div>
              <div class="text-xs text-blue-100">verified</div>
            </div>
            <div class="text-center">
              <div class="text-2xl font-bold">42</div>
              <div class="text-xs text-blue-100">posts</div>
            </div>
          </div>
          <button onclick="showCommunity('visa')" class="w-full bg-white text-blue-600 py-2 rounded-xl font-bold text-sm">
            View Community
          </button>
        </div>

        <!-- Community List -->
        <div class="space-y-3">
          <div onclick="showCommunity('career')" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center text-2xl">üíº</div>
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="font-bold text-gray-900">Career & OPT Support</h3>
                  <span class="bg-orange-100 text-orange-700 px-2 py-0.5 rounded text-xs font-bold">Career Services</span>
                </div>
                <p class="text-xs text-gray-600 mb-1">Job search, resume reviews, OPT applications, interview prep</p>
                <p class="text-xs text-gray-500">156 members ‚Ä¢ 78% verified</p>
              </div>
              <span class="text-gray-400">‚Ä∫</span>
            </div>
          </div>

          <div onclick="showCommunity('housing')" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center text-2xl">üè†</div>
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="font-bold text-gray-900">Housing & Safety</h3>
                  <span class="bg-red-100 text-red-700 px-2 py-0.5 rounded text-xs font-bold">Public Safety</span>
                </div>
                <p class="text-xs text-gray-600 mb-1">Apartment hunting, roommate matching, neighborhood safety, lease advice</p>
                <p class="text-xs text-gray-500">203 members ‚Ä¢ 85% verified</p>
              </div>
              <span class="text-gray-400">‚Ä∫</span>
            </div>
          </div>

          <div onclick="showCommunity('academic')" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center text-2xl">üìö</div>
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="font-bold text-gray-900">Academic Resources</h3>
                  <span class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-bold">TC Faculty</span>
                </div>
                <p class="text-xs text-gray-600 mb-1">Study tips, course recommendations, writing center, tutoring services</p>
                <p class="text-xs text-gray-500">187 members ‚Ä¢ 92% verified</p>
              </div>
              <span class="text-gray-400">‚Ä∫</span>
            </div>
          </div>

          <div onclick="showCommunity('social')" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-12 h-12 bg-pink-100 rounded-xl flex items-center justify-center text-2xl">üéâ</div>
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="font-bold text-gray-900">Social & Events</h3>
                  <span class="bg-pink-100 text-pink-700 px-2 py-0.5 rounded text-xs font-bold">Student Life</span>
                </div>
                <p class="text-xs text-gray-600 mb-1">Meetups, cultural events, friend groups, weekend activities</p>
                <p class="text-xs text-gray-500">312 members ‚Ä¢ 65% verified</p>
              </div>
              <span class="text-gray-400">‚Ä∫</span>
            </div>
          </div>
          
          <div onclick="showCommunity('health')" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-12 h-12 bg-teal-100 rounded-xl flex items-center justify-center text-2xl">üè•</div>
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="font-bold text-gray-900">Health & Wellness</h3>
                  <span class="bg-teal-100 text-teal-700 px-2 py-0.5 rounded text-xs font-bold">CPS Verified</span>
                </div>
                <p class="text-xs text-gray-600 mb-1">Insurance, CPS counseling, medical appointments, mental health</p>
                <p class="text-xs text-gray-500">142 members ‚Ä¢ 88% verified</p>
              </div>
              <span class="text-gray-400">‚Ä∫</span>
            </div>
          </div>
        </div>
      </div>

      <!-- COMMUNITY DETAIL (F-1 Visa) -->
      <div id="community-detail" class="page-view p-5 space-y-4">
        <div class="flex items-center gap-3 mb-2">
          <button onclick="showPage('communities')" class="text-blue-600 font-semibold">‚Äπ Back</button>
        </div>

        <!-- Community Header -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <div class="flex items-center gap-3 mb-3">
            <div class="w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center text-3xl" id="community-emoji">üéì</div>
            <div class="flex-1">
              <h2 id="community-name" class="text-xl font-bold text-gray-900 mb-1">F-1 Visa Help</h2>
              <div id="community-description-section" class="hidden">
                <p id="community-description" class="text-sm text-gray-600 mb-2">Official verified information for international students. Moderated by OISS staff.</p>
                <div class="flex items-center gap-2 flex-wrap mb-2">
                  <span id="community-members" class="bg-green-100 text-green-700 px-2 py-1 rounded-lg text-xs font-semibold">248 members</span>
                  <span id="community-verified" class="bg-blue-100 text-blue-700 px-2 py-1 rounded-lg text-xs font-semibold">89% verified</span>
                  <span id="community-badge" class="bg-purple-100 text-purple-700 px-2 py-1 rounded-lg text-xs font-semibold">OISS Verified</span>
                </div>
                <!-- Community Guidelines -->
                <div id="community-focus-box" class="bg-blue-50 rounded-xl p-3 mb-3">
                  <div class="flex items-start gap-2">
                    <span class="text-lg">‚ÑπÔ∏è</span>
                    <div class="flex-1">
                      <h3 class="font-bold text-blue-900 text-xs mb-1">Community Focus</h3>
                      <p id="community-focus" class="text-xs text-blue-800">Visa status, work authorization (CPT/OPT/STEM OPT), travel, I-20 issues, and official USCIS updates. All visa advice is verified by OISS.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <button onclick="toggleCommunityDescription()" id="community-expand-btn" class="text-gray-400 hover:text-gray-600 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
          </div>
          
          <button onclick="openPostModal()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold text-sm">
            + New Post
          </button>
        </div>

        <!-- Search Bar -->
        <div class="bg-white rounded-2xl p-3 shadow-sm">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
            <input 
              type="text" 
              id="community-search-input" 
              placeholder="Search posts..." 
              class="flex-1 text-sm focus:outline-none"
              oninput="searchCommunityPosts(this.value)"
            />
            <button onclick="clearCommunitySearch()" id="community-search-clear" class="hidden text-gray-400 hover:text-gray-600">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Filter Tabs -->
        <div class="flex gap-2 overflow-x-auto pb-2">
          <button onclick="filterPosts('all')" class="filter-tab active px-4 py-2 bg-blue-600 text-white rounded-xl font-semibold text-sm whitespace-nowrap">All</button>
          <button onclick="filterPosts('verified')" class="filter-tab px-4 py-2 bg-gray-100 text-gray-700 rounded-xl font-semibold text-sm whitespace-nowrap">Verified ‚úì</button>
          <button onclick="filterPosts('flagged')" class="filter-tab px-4 py-2 bg-gray-100 text-gray-700 rounded-xl font-semibold text-sm whitespace-nowrap">Flagged ‚ö†</button>
        </div>

        <!-- Posts Feed -->
        <div id="community-posts" class="space-y-3">
          <!-- Verified Post -->
          <div onclick="openPost(1)" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-start gap-3 mb-2">
              <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">JH</div>
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-1">
                  <span class="font-bold text-gray-900 text-sm">Jiin Hur</span>
                  <span class="bg-green-600 text-white px-2 py-0.5 rounded-full text-xs font-bold">‚úì</span>
                </div>
                <p class="text-xs text-gray-600">TML '26 ‚Ä¢ 1h ago</p>
              </div>
            </div>
            <h3 class="font-bold text-gray-900 mb-2">Best resources for CPT application?</h3>
            <p class="text-sm text-gray-700 mb-2">I found this comprehensive guide from OISS. Has all the forms and requirements clearly listed!</p>
            <div class="bg-blue-50 rounded-xl p-2 mb-2">
              <span class="text-xs text-blue-600 font-semibold">üîó tc.columbia.edu/oiss/cpt-guide</span>
            </div>
            <div class="flex items-center gap-4 text-xs text-gray-600">
              <span>üí¨ 3 comments</span>
              <span>üëç 12 likes</span>
            </div>
          </div>

          <!-- Regular Post -->
          <div onclick="openPost(2)" class="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-start gap-3 mb-2">
              <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">MP</div>
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-1">
                  <span class="font-bold text-gray-900 text-sm">Min Park</span>
                </div>
                <p class="text-xs text-gray-600">TML '27 ‚Ä¢ 2h ago</p>
              </div>
            </div>
            <h3 class="font-bold text-gray-900 mb-2">Study group for EdTech?</h3>
            <p class="text-sm text-gray-700 mb-2">Looking to form a study group for the midterm. Anyone interested?</p>
            <div class="flex items-center gap-4 text-xs text-gray-600">
              <span>üí¨ 5 comments</span>
              <span>üëç 5 likes</span>
            </div>
          </div>

          <!-- FLAGGED Post - Key Example! -->
          <div onclick="openPost(3)" class="bg-red-50 border-2 border-red-200 rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer">
            <div class="flex items-center gap-2 mb-3">
              <span class="bg-red-600 text-white px-2 py-1 rounded-lg text-xs font-bold">‚ö† Community Flagged</span>
              <span class="text-xs text-red-700 font-semibold">Multiple reports</span>
            </div>
            <div class="flex items-start gap-3 mb-2">
              <div class="w-10 h-10 bg-gray-400 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">??</div>
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-1">
                  <span class="font-bold text-gray-900 text-sm">Anonymous</span>
                </div>
                <p class="text-xs text-gray-600">4h ago</p>
              </div>
            </div>
            <h3 class="font-bold text-gray-900 mb-2">URGENT: OPT applications suspended!</h3>
            <p class="text-sm text-gray-700 mb-2">My friend at NYU said USCIS stopped processing...</p>
            <div class="bg-yellow-50 border border-yellow-300 rounded-xl p-2 mb-2">
              <p class="text-xs text-yellow-800">‚ö† No source provided ‚Ä¢ May contain misinformation</p>
            </div>
            <div class="flex items-center gap-4 text-xs text-gray-600">
              <span>üí¨ 8 comments</span>
              <span class="text-red-600 font-semibold">üö® 5 reports</span>
            </div>
          </div>
        </div>
      </div>

      <!-- POST DETAIL -->
      <div id="post-detail" class="page-view p-5 space-y-4">
        <div class="flex items-center gap-3 mb-2">
          <button onclick="showPage('community-detail')" class="text-blue-600 font-semibold">‚Äπ Back</button>
        </div>

        <!-- Post Content -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <!-- Flagged Post Warning Banner -->
          <div id="flagged-warning" class="bg-red-50 border-2 border-red-300 rounded-xl p-4 mb-4 hidden">
            <div class="flex items-start gap-3">
              <div class="text-2xl">‚ö†Ô∏è</div>
              <div class="flex-1">
                <h3 class="font-bold text-red-900 text-sm mb-1">Community Flagged: Potential Misinformation</h3>
                <p class="text-xs text-red-800 mb-2">This post has been reported by multiple community members and may contain inaccurate information. Please verify with official sources before acting on this content.</p>
                <div class="bg-red-100 rounded-lg p-2">
                  <p class="text-xs text-red-900 font-semibold">‚úì Always check verified posts and official sources (OISS, Career Services, etc.)</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="flex items-start gap-3 mb-3">
            <div id="post-author-avatar" class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold flex-shrink-0">JH</div>
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <span id="post-author-name" class="font-bold text-gray-900">Jiin Hur</span>
                <span id="post-badge" class="bg-green-600 text-white px-2 py-0.5 rounded-full text-xs font-bold">‚úì</span>
              </div>
              <p id="post-author-meta" class="text-xs text-gray-600">TML '26 ‚Ä¢ 1h ago</p>
            </div>
            <div class="flex items-center gap-2">
              <button id="post-bookmark-btn" onclick="toggleSavePost(event)" class="text-gray-400 hover:text-blue-600 transition-colors">
                <svg id="post-bookmark-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/></svg>
              </button>
              <button onclick="openReportModal(event, 1)" class="text-gray-400 hover:text-red-600">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"/></svg>
              </button>
            </div>
          </div>
          <h2 id="post-title" class="text-lg font-bold text-gray-900 mb-2">Best resources for CPT application?</h2>
          <p id="post-content" class="text-sm text-gray-700 mb-3">I found this comprehensive guide from OISS. Has all the forms and requirements clearly listed!</p>
          
          <!-- Warning for flagged posts -->
          <div id="post-warning" class="bg-yellow-50 border border-yellow-300 rounded-xl p-3 mb-3 hidden">
            <p class="text-xs text-yellow-800 font-semibold">‚ö† This post has been flagged by multiple community members for potential misinformation</p>
          </div>
          
          <div id="post-link" class="bg-blue-50 rounded-xl p-3 mb-3 overflow-hidden">
            <span class="text-sm text-blue-600 font-semibold break-all link-text">üîó tc.columbia.edu/oiss/cpt-guide</span>
          </div>
          <div class="flex items-center gap-4 pt-3 border-t border-gray-100">
            <button onclick="likePost(event)" id="like-button" class="flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"/></svg>
              <span id="like-count" class="text-sm font-semibold">12</span>
            </button>
            <button onclick="dislikePost(event)" id="dislike-button" class="flex items-center gap-2 text-gray-600 hover:text-red-600 transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M18 9.5a1.5 1.5 0 11-3 0v-6a1.5 1.5 0 013 0v6zM14 9.667v-5.43a2 2 0 00-1.105-1.79l-.05-.025A4 4 0 0011.055 2H5.64a2 2 0 00-1.962 1.608l-1.2 6A2 2 0 004.44 12H8v4a2 2 0 002 2 1 1 0 001-1v-.667a4 4 0 01.8-2.4l1.4-1.866a4 4 0 00.8-2.4z"/></svg>
              <span id="dislike-count" class="text-sm font-semibold">2</span>
            </button>
            <div class="flex items-center gap-2 text-gray-600">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/></svg>
              <span id="comment-count" class="text-sm font-semibold">5 comments</span>
            </div>
          </div>
        </div>

        <!-- Comments Section -->
        <div class="space-y-3">
          <!-- Comments will be dynamically inserted here -->
        </div>

        <!-- Add Comment -->
        <div class="bg-white rounded-2xl p-4 shadow-sm mt-4">
          <textarea id="comment-input" placeholder="Add a comment..." rows="2" class="w-full px-3 py-2 rounded-xl bg-gray-50 mb-2 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
              <label class="flex items-center gap-1 text-xs text-gray-600 cursor-pointer">
                <input type="checkbox" id="comment-verification-checkbox" onchange="toggleCommentVerification()" class="w-4 h-4" />
                <span>Add source</span>
              </label>
            </div>
            <button onclick="postComment()" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold text-sm hover:bg-blue-700 transition-colors">Post</button>
          </div>
          <div id="comment-source-input" class="hidden mt-2">
            <input type="url" id="comment-source-url" placeholder="Source URL (e.g., tc.columbia.edu/oiss)" class="w-full px-3 py-2 rounded-xl bg-blue-50 border border-blue-200 text-xs focus:outline-none" />
            <p class="text-xs text-blue-600 mt-1">‚úì Moderators will verify this source</p>
          </div>
        </div>
      </div>

      <!-- SCHEDULE PAGE -->
      <div id="schedule" class="page-view p-5 space-y-4">
        <div class="flex items-center gap-2 mb-2">
          <h2 id="schedule-title" class="text-2xl font-bold text-gray-900">My Schedule</h2>
          <button onclick="openScheduleInfoModal()" class="w-6 h-6 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 hover:bg-purple-200 transition-colors">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
            </svg>
          </button>
        </div>
        
        <!-- Compact Stats Badge -->
        <div class="bg-gradient-to-r from-purple-50 to-purple-100 rounded-2xl p-3 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center text-white text-lg">ü§ù</div>
            <div>
              <p class="text-xs font-semibold text-purple-900">Academic Handshake</p>
              <p class="text-xs text-purple-700">Shared with 3 connections</p>
            </div>
          </div>
          <button onclick="openAcademicHandshakeModal()" class="text-xs text-purple-600 font-semibold hover:text-purple-800">
            Connect
          </button>
        </div>

        <!-- Schedule Grid -->
        <div class="bg-white rounded-3xl p-4 shadow-sm">
          <div id="schedule-error" class="hidden bg-red-50 border border-red-200 rounded-xl p-4 mb-4">
            <p class="text-sm text-red-700 font-semibold mb-1">üîí No Schedule Access</p>
            <p class="text-xs text-red-600 mb-3">This user hasn't shared their schedule with you yet.</p>
            <button id="view-profile-btn" onclick="viewScheduleConnectionProfile()" class="w-full bg-purple-600 text-white py-2 rounded-xl font-semibold text-sm hover:bg-purple-700 transition-colors">
              View Academic Profile
            </button>
          </div>
          <div id="schedule-view-profile-container" class="hidden mb-4">
            <button id="view-profile-btn-visible" onclick="viewScheduleConnectionProfile()" class="w-full bg-purple-600 text-white py-2.5 rounded-xl font-semibold text-sm hover:bg-purple-700 transition-colors flex items-center justify-center gap-2">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/></svg>
              View Academic Profile
            </button>
          </div>
          <div id="schedule-grid">
            <!-- Schedule will be rendered here -->
          </div>
        </div>

        <!-- Connected Students -->
        <div class="bg-white rounded-3xl p-4 shadow-sm">
          <h3 class="font-bold text-gray-900 mb-3">Connected Students</h3>
          <div id="connected-students-list" class="space-y-2">
            <!-- My Schedule button and connected students will be dynamically rendered here -->
          </div>
        </div>
      </div>

      <!-- PROFILE PAGE -->
      <div id="profile" class="page-view p-5 space-y-4">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-2xl font-bold text-gray-900">My Profile</h2>
          <button onclick="handleLogout()" class="text-red-600 text-sm font-semibold">Logout</button>
        </div>

        <!-- Profile Header -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <div class="flex items-start gap-3 mb-4">
            <div class="relative flex-shrink-0">
              <img src="https://i.pinimg.com/736x/df/2f/dc/df2fdc0cc7a11a701bcf167a6142aa6d.jpg" class="w-20 h-20 rounded-full object-cover shadow-md" style="aspect-ratio: 1/1;" />
              <div class="absolute -bottom-1 -right-1 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center border-2 border-white">
                <span class="text-white text-xs">‚úì</span>
              </div>
            </div>
            <div class="flex-1 min-w-0">
              <h1 id="profile-name-display" class="text-xl font-bold text-gray-900 mb-1">Haetal Kim</h1>
              <p id="profile-major-display" class="text-sm text-gray-600 mb-1">Instructional Technology & Media</p>
              <p id="profile-email-display" class="text-sm text-blue-400">haetalkim@tc.columbia.edu</p>
            </div>
          </div>
          <div class="bg-blue-50 rounded-xl px-3 py-2 text-center mb-4">
            <span id="profile-verification-status" class="text-xs font-semibold text-blue-700">‚úì Verified Student</span>
          </div>
          <button onclick="openEditProfileModal()" class="w-full bg-blue-600 text-white py-2.5 rounded-xl font-semibold text-sm hover:bg-blue-700 transition-colors">
            Edit Profile
          </button>
        </div>

        <!-- Academic Information -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <h3 class="text-base font-bold text-gray-900 mb-4">Academic Information</h3>
          <div class="space-y-3">
            <div>
              <p class="text-xs text-gray-500 mb-1">Program</p>
              <p id="profile-program-display" class="text-sm font-semibold text-gray-900">Technology & Media (TML)</p>
            </div>
            <div>
              <p class="text-xs text-gray-500 mb-1">Degree</p>
              <p id="profile-degree-display" class="text-sm font-semibold text-gray-900">Master of Arts (MA)</p>
            </div>
            <div>
              <p class="text-xs text-gray-500 mb-1">Year</p>
              <p id="profile-year-display" class="text-sm font-semibold text-gray-900">2026</p>
            </div>
            <div>
              <p class="text-xs text-gray-500 mb-1">Major/Concentration</p>
              <p id="profile-major-full-display" class="text-sm font-semibold text-gray-900">Instructional Technology & Media</p>
            </div>
            <div id="profile-research-container">
              <p class="text-xs text-gray-500 mb-1">Research Interest</p>
              <p id="profile-research-display" class="text-sm text-gray-900">Educational Technology, Learning Analytics</p>
            </div>
            <div id="profile-lab-container" class="hidden">
              <p class="text-xs text-gray-500 mb-1">Lab/Research Group</p>
              <p id="profile-lab-display" class="text-sm text-gray-900">-</p>
            </div>
            <div id="profile-linkedin-container" class="hidden">
              <p class="text-xs text-gray-500 mb-1">LinkedIn</p>
              <a id="profile-linkedin-display" href="#" target="_blank" class="text-sm text-blue-600 hover:underline">View Profile</a>
            </div>
          </div>
        </div>

        <!-- Schedule Sharing Consent -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <h3 class="text-base font-bold text-gray-900 mb-3">Academic Handshake</h3>
          <div class="flex items-center justify-between bg-purple-50 rounded-xl p-3 mb-3">
            <div>
              <p class="text-sm font-semibold text-purple-900 mb-1">Include Schedule Sharing</p>
              <p class="text-xs text-purple-700">Optionally share your class schedule with connected peers</p>
            </div>
            <label class="relative inline-flex items-center cursor-pointer">
              <input type="checkbox" id="schedule-sharing-toggle" onchange="toggleScheduleSharing()" class="sr-only peer" checked>
              <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
            </label>
          </div>
          <p id="schedule-sharing-status" class="text-xs text-gray-600">‚úì Your schedule is being shared with 3 connections</p>
          <p class="text-xs text-gray-500 mt-2">Note: Your academic information (major, program, research interests, lab) is always shared when you connect. Schedule sharing is optional.</p>
        </div>

        <!-- Connected Network -->
        <div class="bg-white rounded-3xl p-5 shadow-sm">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-base font-bold text-gray-900">My Network</h3>
            <button onclick="openAcademicHandshakeModal()" class="text-blue-600 text-sm font-semibold">+ Connect</button>
          </div>
          <div id="network-list" class="space-y-2">
            <!-- Network connections will be dynamically added here -->
          </div>
        </div>
      </div>

      <!-- CHAT PAGE -->
      <div id="chat" class="page-view p-5 space-y-3">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Messages</h2>
        <div id="chat-list-container" class="space-y-3">
          <!-- Chat list will be dynamically rendered here -->
        </div>
      </div>

      <!-- CHAT DETAIL/CONVERSATION PAGE -->
      <div id="chat-detail" class="page-view flex flex-col h-full p-0">
        <!-- Chat Header -->
        <div class="flex items-center gap-3 p-4 border-b border-gray-200 bg-white flex-shrink-0">
          <button onclick="showPage('chat')" class="text-blue-600 font-semibold">‚Äπ Back</button>
          <div id="chat-detail-avatar" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold flex-shrink-0">TC</div>
          <div class="flex-1 min-w-0">
            <h2 id="chat-detail-name" class="font-bold text-gray-900">TML CA</h2>
            <p id="chat-detail-status" class="text-xs text-gray-500">Online</p>
          </div>
        </div>

        <!-- Messages Container -->
        <div id="chat-messages-container" class="flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 min-h-0">
          <!-- Messages will be dynamically rendered here -->
        </div>

        <!-- Message Input -->
        <div class="p-4 bg-gray-50 border-t border-gray-200 flex-shrink-0">
          <div class="flex items-center gap-2">
            <input 
              type="text" 
              id="chat-message-input" 
              placeholder="Type a message..." 
              class="flex-1 px-4 py-2.5 rounded-full bg-white border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
              onkeypress="if(event.key === 'Enter') sendChatMessage()"
            />
            <button 
              onclick="sendChatMessage()" 
              class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors flex-shrink-0"
            >
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/></svg>
            </button>
          </div>
        </div>
      </div>

      <!-- BOOKMARKS PAGE -->
      <div id="folder" class="page-view p-5 space-y-3">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Saved</h2>
        <div id="saved-posts-container" class="space-y-3">
          <!-- Saved posts will be dynamically rendered here -->
        </div>
      </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="glass border-t border-gray-200 px-4 py-2 flex items-center justify-around absolute bottom-0 left-0 right-0 z-50">
      <button onclick="showPage('home')" class="nav-item active flex flex-col items-center gap-1" data-page="home">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/></svg>
        <span class="text-xs">Home</span>
      </button>
      <button onclick="showPage('communities')" class="nav-item flex flex-col items-center gap-1 text-gray-600" data-page="communities">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"/></svg>
        <span class="text-xs">Community</span>
      </button>
      <button onclick="showPage('schedule')" class="nav-item flex flex-col items-center gap-1 text-gray-600" data-page="schedule">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/></svg>
        <span class="text-xs">Schedule</span>
      </button>
      <button onclick="showPage('chat')" class="nav-item flex flex-col items-center gap-1 text-gray-600" data-page="chat">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/></svg>
        <span class="text-xs">Chat</span>
      </button>
      <button onclick="showPage('folder')" class="nav-item flex flex-col items-center gap-1 text-gray-600" data-page="folder">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"/></svg>
        <span class="text-xs">Saved</span>
      </button>
    </nav>

    <!-- Post Modal -->
    <div id="post-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-5 shadow-2xl mx-4">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-base font-bold text-gray-900">Create Post</h3>
          <button onclick="closePostModal()" class="text-gray-400 text-xl">&times;</button>
        </div>
        
        <!-- Community Selector -->
        <div class="mb-3">
          <label class="text-xs font-semibold text-gray-700 mb-1 block">Select Community</label>
          <select id="post-community-select" class="w-full px-3 py-2 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="visa">üéì F-1 Visa Help (OISS Verified)</option>
            <option value="career">üíº Career & OPT Support</option>
            <option value="housing">üè† Housing & Safety</option>
            <option value="academic">üìö Academic Resources</option>
            <option value="social">üéâ Social & Events</option>
            <option value="health">üè• Health & Wellness</option>
          </select>
        </div>
        
        <input type="text" placeholder="Title" class="w-full px-3 py-2 rounded-xl bg-gray-50 mb-2 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <textarea placeholder="Share information to help our community..." rows="3" class="w-full px-3 py-2 rounded-xl bg-gray-50 mb-2 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
        
        <!-- Emphasis on verification for combating misinformation -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-3 mb-3">
          <p class="text-xs text-yellow-800 mb-2"><span class="font-bold">üí° Help fight misinformation:</span> Adding a source helps moderators verify your information and builds community trust.</p>
        </div>
        
        <div class="flex items-center justify-between bg-gray-50 p-2 rounded-xl mb-2">
          <span class="text-xs font-semibold text-gray-900">Post anonymously</span>
          <input type="checkbox" id="post-anon-checkbox" class="w-4 h-4" />
        </div>
        <div class="flex items-center justify-between bg-blue-50 p-2 rounded-xl mb-2">
          <span class="text-xs font-semibold text-gray-900">Add Source for Verification</span>
          <input type="checkbox" id="verification-checkbox" onchange="toggleVerification()" class="w-4 h-4" />
        </div>
        <div id="source-input" class="hidden mb-2">
          <input type="url" placeholder="Source URL (e.g., tc.columbia.edu/oiss, uscis.gov)" class="w-full px-3 py-2 rounded-xl bg-blue-50 border border-blue-200 text-xs focus:outline-none" />
          <p class="text-xs text-blue-600 mt-1">‚úì Moderators will verify this source</p>
        </div>
        <button onclick="submitPost()" class="w-full bg-blue-600 text-white py-2 rounded-xl font-bold text-sm hover:bg-blue-700 transition-colors">Post</button>
      </div>
    </div>

    <!-- Report Modal -->
    <div id="report-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-5 shadow-2xl mx-4">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-base font-bold text-red-600">‚ö†Ô∏è Report Content</h3>
          <button onclick="closeReportModal()" class="text-gray-400 text-xl">&times;</button>
        </div>
        <div class="bg-red-50 border border-red-200 rounded-xl p-3 mb-3">
          <p class="text-xs text-red-700">Help keep our community safe by reporting concerning content. Your report will be reviewed by moderators.</p>
        </div>
        <select class="w-full px-3 py-2 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none mb-2">
          <option>Misinformation / False claims</option>
          <option>No source provided</option>
          <option>Misleading title</option>
          <option>Spam or promotional</option>
          <option>Inappropriate content</option>
        </select>
        <textarea placeholder="Additional details (optional)" rows="2" class="w-full px-3 py-2 rounded-xl bg-gray-50 mb-3 border border-gray-200 text-sm focus:outline-none"></textarea>
        <button onclick="submitReport()" class="w-full bg-red-600 text-white py-2 rounded-xl font-bold text-sm hover:bg-red-700 transition-colors">Submit Report</button>
      </div>
    </div>

    <!-- Academic Handshake Modal -->
    <div id="academic-handshake-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-[60] items-center justify-center overflow-y-auto py-4">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-4 shadow-2xl mx-4 my-auto max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-base font-bold text-purple-900">ü§ù Academic Handshake</h3>
          <button onclick="closeAcademicHandshakeModal()" class="text-gray-400 text-lg hover:text-gray-600">&times;</button>
        </div>
        
        <!-- Tab Buttons -->
        <div class="flex gap-2 mb-3 bg-gray-100 rounded-xl p-1">
          <button 
            onclick="switchHandshakeTab('generate')" 
            id="handshake-generate-tab"
            class="flex-1 py-1.5 rounded-lg font-semibold text-xs transition-colors bg-purple-600 text-white"
          >
            Generate Code
          </button>
          <button 
            onclick="switchHandshakeTab('input')" 
            id="handshake-input-tab"
            class="flex-1 py-1.5 rounded-lg font-semibold text-xs transition-colors text-gray-600 hover:text-gray-900"
          >
            Enter Code
          </button>
        </div>

        <!-- Generate Code Tab -->
        <div id="handshake-generate-container">
          <div class="bg-purple-50 rounded-xl p-3 mb-3 text-center">
            <p class="text-[10px] text-purple-700 mb-2">Share this code with a peer to connect</p>
            <div id="generated-code-display" class="text-3xl font-bold text-purple-900 mb-1 font-mono tracking-widest">----</div>
            <p class="text-[10px] text-purple-600">Code expires in <span id="code-expiry-timer">5:00</span></p>
          </div>
          <button 
            onclick="generateHandshakeCode()" 
            id="generate-code-btn"
            class="w-full bg-purple-600 text-white py-2 rounded-xl font-semibold text-xs hover:bg-purple-700 transition-colors mb-3"
          >
            Generate New Code
          </button>
          <div class="bg-blue-50 rounded-xl p-2.5">
            <p class="text-[10px] text-blue-800">
              <span class="font-semibold">üí° Tip:</span> When someone enters your code, you'll see their academic profile (major, program, research interests, lab). You can also optionally share your class schedule with them.
            </p>
          </div>
        </div>

        <!-- Input Code Tab -->
        <div id="handshake-input-container" class="hidden">
          <form id="handshake-code-form" onsubmit="submitHandshakeCode(event)" class="space-y-3">
            <div>
              <label class="text-[10px] font-semibold text-gray-700 mb-1.5 block">Enter 4-Digit Code</label>
              <input 
                type="text" 
                id="handshake-code-input" 
                placeholder="0000" 
                maxlength="4"
                pattern="[0-9]{4}"
                inputmode="numeric"
                class="w-full px-3 py-3 rounded-xl bg-gray-50 border border-gray-200 text-center text-2xl font-bold tracking-widest focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                required
                oninput="this.value = this.value.replace(/[^0-9]/g, '')"
              />
              <p class="text-[10px] text-gray-500 mt-1.5 text-center">Enter the code shared by your peer</p>
            </div>
            
            <button 
              type="submit" 
              class="w-full bg-purple-600 text-white py-2 rounded-xl font-semibold text-xs hover:bg-purple-700 transition-colors"
            >
              Connect
            </button>
          </form>
          
          <div class="bg-purple-50 rounded-xl p-2.5 mt-3">
            <p class="text-[10px] text-purple-800">
              <span class="font-semibold">üîí Privacy:</span> You'll see their academic info (major, program, research interests, lab), and they'll see yours. Schedule sharing is optional and requires your consent.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule Info Modal (Keep for Learn More button) -->
    <div id="schedule-info-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center overflow-y-auto py-4">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-4 shadow-2xl mx-4 my-auto max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-base font-bold text-purple-900">ü§ù Academic Handshake</h3>
          <button onclick="closeScheduleInfoModal()" class="text-gray-400 text-lg">&times;</button>
        </div>
        
        <div class="space-y-2.5 mb-3">
          <div class="bg-purple-50 rounded-xl p-2.5">
            <h4 class="font-semibold text-purple-900 text-xs mb-1">What is Academic Handshake?</h4>
            <p class="text-[10px] text-purple-700">A way to share academic information and network with peers who have similar interests, without oversharing or worrying about privacy. Share your major, program, degree, class of graduation, research interests, and lab to make meaningful connections.</p>
          </div>
          
          <div class="bg-blue-50 rounded-xl p-2.5">
            <h4 class="font-semibold text-blue-900 text-xs mb-1">‚úì Privacy-First</h4>
            <p class="text-[10px] text-blue-700">You control what you share. Academic information is shared when you connect, but schedule sharing is optional and requires your explicit consent.</p>
          </div>
          
          <div class="bg-green-50 rounded-xl p-2.5">
            <h4 class="font-semibold text-green-900 text-xs mb-1">üéØ What You Can Share</h4>
            <ul class="text-[10px] text-green-700 space-y-0.5">
              <li>‚Ä¢ Major/Concentration</li>
              <li>‚Ä¢ Program & Degree</li>
              <li>‚Ä¢ Class of Graduation</li>
              <li>‚Ä¢ Research Interests</li>
              <li>‚Ä¢ Lab/Research Group</li>
              <li>‚Ä¢ Class Schedule (optional)</li>
            </ul>
          </div>
        </div>
        
        <button onclick="closeScheduleInfoModal(); openAcademicHandshakeModal();" class="w-full bg-purple-600 text-white py-2 rounded-xl font-semibold text-xs hover:bg-purple-700 transition-colors mb-2">Connect Now</button>
        <button onclick="closeScheduleInfoModal()" class="w-full bg-gray-100 text-gray-700 py-2 rounded-xl font-semibold text-xs hover:bg-gray-200 transition-colors">Got it!</button>
      </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-[60] items-center justify-center overflow-y-auto py-4">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-4 shadow-2xl mx-4 my-auto max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-base font-bold text-gray-900">Edit Profile</h3>
          <button onclick="closeEditProfileModal()" class="text-gray-400 text-lg hover:text-gray-600">&times;</button>
        </div>
        
        <form id="edit-profile-form" onsubmit="saveProfileChanges(event)" class="space-y-4">
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Full Name</label>
            <input 
              type="text" 
              id="edit-name" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Program</label>
            <select 
              id="edit-program" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
              <option value="">Select your program</option>
              <option value="TML">Technology & Media (TML)</option>
              <option value="C&T">Curriculum & Teaching (C&T)</option>
              <option value="HUDK">Human Development (HUDK)</option>
              <option value="A&HA">Arts & Humanities (A&HA)</option>
              <option value="ORL">Organization & Leadership (ORL)</option>
              <option value="HBS">Health & Behavior Studies (HBS)</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Degree</label>
            <select 
              id="edit-degree" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
              <option value="">Select your degree</option>
              <option value="MA">Master of Arts (MA)</option>
              <option value="MS">Master of Science (MS)</option>
              <option value="EdM">Master of Education (EdM)</option>
              <option value="EdD">Doctor of Education (EdD)</option>
              <option value="PhD">Doctor of Philosophy (PhD)</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Year</label>
            <select 
              id="edit-year" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            >
              <option value="">Select your year</option>
              <option value="2024">2024</option>
              <option value="2025">2025</option>
              <option value="2026">2026</option>
              <option value="2027">2027</option>
              <option value="2028">2028</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Major/Concentration</label>
            <input 
              type="text" 
              id="edit-major" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Research Interest</label>
            <textarea 
              id="edit-research-interest" 
              rows="2"
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
              required
            ></textarea>
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">LinkedIn Profile (Optional)</label>
            <input 
              type="url" 
              id="edit-linkedin" 
              placeholder="https://linkedin.com/in/yourprofile" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Lab/Research Group (Optional)</label>
            <input 
              type="text" 
              id="edit-lab" 
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
          
          <div>
            <label class="text-xs font-semibold text-gray-700 mb-2 block">Interests (Optional)</label>
            <textarea 
              id="edit-interests" 
              rows="2"
              class="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
            ></textarea>
            <p class="text-xs text-gray-500 mt-1">Separate interests with commas</p>
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold text-sm hover:bg-blue-700 transition-colors"
          >
            Save Changes
          </button>
        </form>
      </div>
    </div>

    <!-- OISS Authorization Modal -->
    <div id="oiss-authorization-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-[60] items-center justify-center">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-6 shadow-2xl mx-4 my-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-blue-900">Community Creation</h3>
          <button onclick="closeOISSAuthorizationModal()" class="text-gray-400 text-xl hover:text-gray-600">&times;</button>
        </div>
        
        <div class="bg-blue-50 rounded-xl p-4 mb-4">
          <div class="flex items-start gap-3">
            <div class="text-2xl">‚ÑπÔ∏è</div>
            <div class="flex-1">
              <h4 class="font-semibold text-blue-900 text-sm mb-2">Authorization Required</h4>
              <p class="text-xs text-blue-800 mb-3">Creating a new community requires authorization from OISS (Office of International Students and Scholars) or the appropriate committee.</p>
              <p class="text-xs text-blue-800 font-semibold">Please contact OISS at:</p>
              <a href="mailto:oiss@tc.columbia.edu" class="text-xs text-blue-600 hover:underline block mt-1">oiss@tc.columbia.edu</a>
              <p class="text-xs text-blue-700 mt-2">Or visit: <span class="font-semibold">tc.columbia.edu/oiss</span></p>
            </div>
          </div>
        </div>
        
        <button onclick="closeOISSAuthorizationModal()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold text-sm hover:bg-blue-700 transition-colors">
          Got it
        </button>
      </div>
    </div>

    <!-- Trust Score Info Modal -->
    <div id="trust-score-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center overflow-y-auto py-4">
      <div class="bg-white rounded-3xl w-10/12 max-w-sm p-4 shadow-2xl mx-4 my-auto max-h-[85vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-base font-bold text-green-900">üìä Trust Score</h3>
          <button onclick="closeTrustScoreModal()" class="text-gray-400 text-lg">&times;</button>
        </div>
        
        <div class="space-y-2.5 mb-3">
          <div class="bg-green-50 rounded-xl p-2.5">
            <h4 class="font-semibold text-green-900 text-xs mb-1.5">How It's Calculated</h4>
            <div class="space-y-1.5 text-[10px] text-green-800">
              <div class="flex items-start gap-1.5">
                <span class="font-bold text-xs">‚úì</span>
                <p>Verified Posts: Sources checked by TML moderators or OISS staff</p>
              </div>
              <div class="flex items-start gap-1.5">
                <span class="font-bold text-xs">üìä</span>
                <p>Formula: (Verified Posts √∑ Total Posts) √ó 100</p>
              </div>
              <div class="flex items-start gap-1.5">
                <span class="font-bold text-xs">‚öñÔ∏è</span>
                <p>Community Weight: Each community's rate contributes to overall score</p>
              </div>
            </div>
          </div>
          
          <div class="bg-blue-50 rounded-xl p-2.5">
            <h4 class="font-semibold text-blue-900 text-xs mb-1.5">What Affects the Score</h4>
            <div class="space-y-1 text-[10px] text-blue-800">
              <p>‚úÖ Verified sources <span class="font-semibold">(+)</span></p>
              <p>‚ö†Ô∏è Flagged posts removed <span class="font-semibold">(neutral)</span></p>
              <p>üìù Unverified posts <span class="font-semibold">(counted)</span></p>
              <p>üö® Corrected misinformation <span class="font-semibold">(improves)</span></p>
            </div>
          </div>
          
          <div class="bg-yellow-50 rounded-xl p-2.5">
            <h4 class="font-semibold text-yellow-900 text-xs mb-1">Score Ranges</h4>
            <div class="space-y-0.5 text-[10px] text-yellow-800">
              <p><span class="font-bold">90-100:</span> Excellent</p>
              <p><span class="font-bold">75-89:</span> Good</p>
              <p><span class="font-bold">60-74:</span> Fair</p>
              <p><span class="font-bold">&lt;60:</span> Needs Improvement</p>
            </div>
          </div>
          
          <div class="bg-purple-50 rounded-xl p-2.5">
            <p class="text-[10px] text-purple-800">
              <span class="font-semibold">Example:</span> F-1 Visa Help: 89% verified = 35/39 posts verified by OISS
            </p>
          </div>
        </div>
        
        <button onclick="closeTrustScoreModal()" class="w-full bg-green-600 text-white py-2 rounded-xl font-semibold text-xs hover:bg-green-700 transition-colors">Got it!</button>
      </div>
    </div>

    <!-- Success Toast -->
    <div id="success-toast" class="absolute top-20 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-xl shadow-2xl hidden pointer-events-none">
      <div class="flex items-center gap-2">
        <svg class="w-5 h-5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
        <span id="toast-message" class="font-semibold text-sm">Success!</span>
      </div>
    </div>

  </div>
</div>

<script src="script.js"></script>
</body>
</html>